<div class="container">
  <h4 ng-show='user.id'>Perfil</h4>
  <h4 ng-hide='user.id'>Registro de nuevo usuario</h4>
  <form name="form" novalidate class="needs-validation">
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="nombres">Nombres</label>
        <input type="text" ng-model="user.nombres" class="form-control {{form.$dirty?(form.nombres.$valid?'is-valid':'is-invalid'):''}}" name="nombres" required>
        <div class="invalid-feedback" ng-if="form.nombres.$error.required"><i class="fa fa-times"></i> Los nombres son obligatorios</div> 
      </div>
      <div class="form-group col-md-6">
        <label for="apellidos">Apellidos</label>
        <input type="text" ng-model="user.apellidos" class="form-control {{form.$dirty?(form.apellidos.$valid?'is-valid':'is-invalid'):''}}" name="apellidos" required>
        <div class="invalid-feedback" ng-if="form.apellidos.$error.required"><i class="fa fa-times"></i> Los apellidos son obligatorios</div> 
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="nombres">Usuario</label>
        <input type="text" ng-model="user.usuario" class="form-control {{form.$dirty?(form.usuario.$valid && !formErrors.usuario?'is-valid':'is-invalid'):''}}" name="usuario" required>
        <div class="invalid-feedback" ng-if="form.usuario.$error.required"><i class="fa fa-times"></i> El nombre de usuario es obligatorio</div> 
        <div class="invalid-feedback" ng-if="formErrors.usuario"><i class="fa fa-times"></i> El nombre de usuario ya fue tomado</div> 
      </div>
      <div class="form-group col-md-6">
        <label for="email">Correo electrónico</label>
        <input type="text" ng-model="user.email" class="form-control {{form.$dirty?(form.email.$valid && !formErrors.email?'is-valid':'is-invalid'):''}}" name="email" required>
        <div class="invalid-feedback" ng-if="form.email.$error.required"><i class="fa fa-times"></i> El email es obligatorio</div> 
        <div class="invalid-feedback" ng-if="formErrors.email"><i class="fa fa-times"></i> El correo ya está registrado</div> 
      </div>
    </div>
    <div class="form-row" ng-hide='user.id'>
      <div class="form-group col-md-6">
        <label for="password">Contraseña</label>
        <input type="password" ng-model="user.password" class="form-control {{form.$dirty?(form.password.$valid?'is-valid':'is-invalid'):''}}" name="password" required>
        <div class="invalid-feedback" ng-if="form.password.$error.required"><i class="fa fa-times"></i> El password es obligatorio</div> 
      </div>
      <div class="form-group col-md-6">
        <label for="password2">Confirmar contraseña</label>
        <input type="password" ng-model="user.password2" class="form-control {{form.$dirty?((form.password2.$valid && user.password2 == user.password)?'is-valid':'is-invalid'):''}}" name="password2" required>
        <div class="invalid-feedback" ng-if="form.password2.$error.required"><i class="fa fa-times"></i> Debe confirmar la contraseña</div> 
        <div class="invalid-feedback" ng-if="form.password2.$valid && user.password2 != user.password"><i class="fa fa-times"></i> Las contraseñas no coinciden</div> 
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="celular">Teléfono celular</label>
        <input type="text" ng-model="user.celular" class="form-control {{form.$dirty?(form.celular.$valid && !formErrors.celular?'is-valid':'is-invalid'):''}}" name="celular" required>
        <div class="invalid-feedback" ng-if="form.celular.$error.required"><i class="fa fa-times"></i> El celular es obligatorio</div> 
        <div class="invalid-feedback" ng-if="formErrors.celular"><i class="fa fa-times"></i> El teléfono ya está registrado</div> 
      </div>
      <div class="form-group col-md-6">
        <label for="fecnaci">Fecha de nacimiento</label>
        <input type="text" ng-model="user.fecnaci" class="form-control {{form.$dirty?(form.fecnaci.$valid?'is-valid':'is-invalid'):''}}" name="fecnaci" required>
        <div class="invalid-feedback" ng-if="form.fecnaci.$error.required"><i class="fa fa-times"></i> La fecha de nacimiento es obligatoria</div> 
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col-md-12">
        <label for="direccion">Dirección</label>
        <textarea type="text" ng-model="user.direccion" class="form-control {{form.$dirty?(form.direccion.$valid?'is-valid':'is-invalid'):''}}" name="direccion" required></textarea>
        <div class="invalid-feedback" ng-if="form.direccion.$error.required"><i class="fa fa-times"></i> La dirección es obligatoria</div> 
      </div>
    </div>
    <div class="form-row" ng-hide='user.id'>
      <div class="form row">
        <div class="col-md-12 text-center">
          <button ng-hide='form.$dirty' ng-click="form.$dirty = true" type="button" class="btn btn-primary">
            <i class="fa fa-save"></i>
            Guardar
          </button>
          <button ng-show='form.$dirty' ng-click="save()" type="submit" class="btn btn-primary" ng-disabled="form.$invalid || saving || user.password2 != user.password">
            <i class="fa fa-save {{saving?'fa-spin':''}}"></i>
            Guardar
          </button>
        </div>
      </div>
      <br><br>
    </div>
  </form>
</div>